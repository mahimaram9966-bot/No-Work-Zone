<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>No Work Zone - Game Slot Booking</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
body { font-family:'Poppins',sans-serif; background:#f4f8fb; color:#333; text-align:center; margin:0; padding:0; }
header { background: linear-gradient(90deg, #4CAF50, #FF9800); color:white; padding:20px; font-size:24px; font-weight:600; }
.date-picker { margin:15px; display:flex; justify-content:center; align-items:center; gap:10px; }
.slots { display:flex; flex-wrap:wrap; justify-content:center; margin:20px; }
.slot { background:#ffcc80; border-radius:8px; padding:15px; margin:8px; cursor:pointer; font-size:16px; min-width:120px; box-shadow:0 2px 5px rgba(0,0,0,0.2); transition:0.2s; }
.slot:hover { background:#ffb74d; }
.booked { background:#ccc; color:#666; cursor:not-allowed; }
form { display:none; margin-top:20px; background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); width:300px; margin-left:auto; margin-right:auto; }
input, select, button { padding:8px; margin:8px; width:90%; border:1px solid #ccc; border-radius:5px; }
button { background:#4CAF50; color:white; cursor:pointer; font-weight:600; }
button:hover { background:#45a049; }
.nav-btn { background:#FF9800; color:white; border:none; padding:8px 15px; border-radius:5px; cursor:pointer; font-weight:600; }
.nav-btn:hover { background:#fb8c00; }
.confirmation { display:none; margin-top:20px; font-size:18px; color:#2e7d32; }
footer { background:#4CAF50; color:white; padding:10px; margin-top:20px; font-size:14px; }
</style>
</head>
<body>

<header>ðŸŽ¯ No Work Zone â€” Game Slot Booking</header>

<div class="date-picker">
    <button class="nav-btn" onclick="changeDate(-1)">â¬… Previous Day</button>
    <input type="date" id="bookingDate">
    <button class="nav-btn" onclick="changeDate(1)">Next Day âž¡</button>
</div>

<div class="slots" id="slotsContainer"></div>

<form id="bookingForm">
    <h2>Book Slot</h2>
    <input type="text" id="name" placeholder="Your Name" required>
    <input type="tel" id="contact" placeholder="Contact Number" required>
    <label>Number of Players:</label>
    <select id="players" required>
        <option value="">Select</option>
    </select>
    <input type="hidden" id="selectedSlot">
    <button type="submit">Confirm Booking</button>
</form>

<div class="confirmation" id="confirmationMsg"></div>

<footer>Â© 2025 No Work Zone | Contact: info@noworkzone.com</footer>

<script>
const slotsContainer = document.getElementById("slotsContainer");
const bookingForm = document.getElementById("bookingForm");
const confirmationMsg = document.getElementById("confirmationMsg");
const selectedSlotInput = document.getElementById("selectedSlot");
const bookingDateInput = document.getElementById("bookingDate");

// <-- Replace with your Google Apps Script Web App URL -->
const scriptURL = "https://script.google.com/macros/s/AKfycbxLS7lH_R0w1NJ1S9SDkFMx96KkXhQJymAfB3YdyZkHt2_TiYlqn6pNXVQeFhuOamnh/exec";

// Player options
const playersSelect = document.getElementById("players");
for (let i = 1; i <= 6; i++) {
    let opt = document.createElement("option");
    opt.value = i;
    opt.textContent = i;
    playersSelect.appendChild(opt);
}

// Default to today
const today = new Date().toISOString().split("T")[0];
bookingDateInput.value = today;
bookingDateInput.addEventListener("change", generateSlots);

function generateSlots() {
    slotsContainer.innerHTML = "";
    const dateKey = bookingDateInput.value;
    const bookedSlots = JSON.parse(localStorage.getItem("bookedSlots_" + dateKey) || "[]");

    for (let hour = 5; hour < 23; hour++) {
        let start = formatTime(hour);
        let end = formatTime(hour + 1);
        let slotTime = `${start} - ${end}`;

        let slotDiv = document.createElement("div");
        slotDiv.classList.add("slot");
        slotDiv.textContent = slotTime;

        if (bookedSlots.includes(slotTime)) {
            slotDiv.classList.add("booked");
            slotDiv.textContent = slotTime + " (Not Available)";
        } else {
            slotDiv.addEventListener("click", () => selectSlot(slotTime));
        }

        slotsContainer.appendChild(slotDiv);
    }
}

function formatTime(hour) {
    let ampm = hour >= 12 ? "PM" : "AM";
    let displayHour = hour % 12 || 12;
    return `${displayHour}:00 ${ampm}`;
}

function selectSlot(slotTime) {
    bookingForm.style.display = "block";
    confirmationMsg.style.display = "none";
    selectedSlotInput.value = slotTime;
}

bookingForm.addEventListener("submit", function(e) {
    e.preventDefault();
    let name = document.getElementById("name").value.trim();
    let contact = document.getElementById("contact").value.trim();
    let players = document.getElementById("players").value;
    let slotTime = selectedSlotInput.value;
    let dateKey = bookingDateInput.value;

    // Save locally
    let bookedSlots = JSON.parse(localStorage.getItem("bookedSlots_" + dateKey) || "[]");
    bookedSlots.push(slotTime);
    localStorage.setItem("bookedSlots_" + dateKey, JSON.stringify(bookedSlots));

    // Send to Google Apps Script
    fetch(scriptURL, {
        method: 'POST',
        body: JSON.stringify({date: dateKey, slot: slotTime, name: name, contact: contact, players: players})
    })
    .then(response => response.json())
    .then(result => console.log("Booking sent:", result))
    .catch(err => console.error("Error:", err));

    bookingForm.style.display = "none";
    confirmationMsg.textContent = `âœ… Booking Confirmed for ${slotTime} on ${dateKey} â€” ${players} player(s). Thank you, ${name}!`;
    confirmationMsg.style.display = "block";

    generateSlots();
});

function changeDate(days) {
    let currentDate = new Date(bookingDateInput.value);
    currentDate.setDate(currentDate.getDate() + days);
    bookingDateInput.value = currentDate.toISOString().split("T")[0];
    generateSlots();
}

generateSlots();
</script>

</body>
</html>
